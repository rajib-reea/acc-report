| #   | transaction_date | salesperson_id | total_sales | total_transactions | total_quantity_sold |
| --- | ---------------- | -------------- | ----------- | ------------------ | ------------------- |
| 1   | 2025-01-01       | 1              | 1500.00     | 1                  | 10                  |
| 2   | 2025-01-02       |                | 0           | 0                  | 0                   |
| 3   | 2025-01-03       | 1              | 2500.05     | 1                  | 15                  |
| 4   | 2025-01-04       |                | 0           | 0                  | 0                   |
| 5   | 2025-01-05       | 2              | 1000.00     | 1                  | 8                   |
| 6   | 2025-01-06       |                | 0           | 0                  | 0                   |
| 7   | 2025-01-07       |                | 0           | 0                  | 0                   |
| 8   | 2025-01-08       | 1              | 1800.00     | 1                  | 20                  |
| 9   | 2025-01-09       |                | 0           | 0                  | 0                   |
| 10  | 2025-01-10       | 1              | 3000.00     | 1                  | 25                  |
| 11  | 2025-01-11       |                | 0           | 0                  | 0                   |
| 12  | 2025-01-12       |                | 0           | 0                  | 0                   |
| 13  | 2025-01-13       |                | 0           | 0                  | 0                   |
| 14  | 2025-01-14       |                | 0           | 0                  | 0                   |
| 15  | 2025-01-15       |                | 0           | 0                  | 0                   |
| 16  | 2025-01-16       |                | 0           | 0                  | 0                   |
| 17  | 2025-01-17       |                | 0           | 0                  | 0                   |
| 18  | 2025-01-18       |                | 0           | 0                  | 0                   |
| 19  | 2025-01-19       |                | 0           | 0                  | 0                   |
| 20  | 2025-01-20       |                | 0           | 0                  | 0                   |
| 21  | 2025-01-21       |                | 0           | 0                  | 0                   |
| 22  | 2025-01-22       |                | 0           | 0                  | 0                   |
| 23  | 2025-01-23       |                | 0           | 0                  | 0                   |
| 24  | 2025-01-24       |                | 0           | 0                  | 0                   |
| 25  | 2025-01-25       |                | 0           | 0                  | 0                   |
| 26  | 2025-01-26       |                | 0           | 0                  | 0                   |
| 27  | 2025-01-27       |                | 0           | 0                  | 0                   |
| 28  | 2025-01-28       |                | 0           | 0                  | 0                   |
| 29  | 2025-01-29       |                | 0           | 0                  | 0                   |
| 30  | 2025-01-30       |                | 0           | 0                  | 0                   |
| 31  | 2025-01-31       |                | 0           | 0                  | 0                   |
| 32  | 2025-02-01       |                | 0           | 0                  | 0                   |
| 33  | 2025-02-02       |                | 0           | 0                  | 0                   |
| 34  | 2025-02-03       |                | 0           | 0                  | 0                   |
| 35  | 2025-02-04       |                | 0           | 0                  | 0                   |
| 36  | 2025-02-05       |                | 0           | 0                  | 0                   |
| 37  | 2025-02-06       |                | 0           | 0                  | 0                   |
| 38  | 2025-02-07       |                | 0           | 0                  | 0                   |
| 39  | 2025-02-08       |                | 0           | 0                  | 0                   |
| 40  | 2025-02-09       |                | 0           | 0                  | 0                   |
| 41  | 2025-02-10       |                | 0           | 0                  | 0                   |
| 42  | 2025-02-11       |                | 0           | 0                  | 0                   |
| 43  | 2025-02-12       |                | 0           | 0                  | 0                   |
| 44  | 2025-02-13       |                | 0           | 0                  | 0                   |
| 45  | 2025-02-14       |                | 0           | 0                  | 0                   |
| 46  | 2025-02-15       |                | 0           | 0                  | 0                   |
| 47  | 2025-02-16       |                | 0           | 0                  | 0                   |
| 48  | 2025-02-17       |                | 0           | 0                  | 0                   |
| 49  | 2025-02-18       |                | 0           | 0                  | 0                   |
| 50  | 2025-02-19       |                | 0           | 0                  | 0                   |
| 51  | 2025-02-20       |                | 0           | 0                  | 0                   |
| 52  | 2025-02-21       |                | 0           | 0                  | 0                   |
| 53  | 2025-02-22       |                | 0           | 0                  | 0                   |
| 54  | 2025-02-23       |                | 0           | 0                  | 0                   |
| 55  | 2025-02-24       |                | 0           | 0                  | 0                   |
| 56  | 2025-02-25       |                | 0           | 0                  | 0                   |
| 57  | 2025-02-26       |                | 0           | 0                  | 0                   |
| 58  | 2025-02-27       |                | 0           | 0                  | 0                   |
| 59  | 2025-02-28       |                | 0           | 0                  | 0                   |
| 60  | 2025-03-01       |                | 0           | 0                  | 0                   |
| 61  | 2025-03-02       |                | 0           | 0                  | 0                   |
| 62  | 2025-03-03       |                | 0           | 0                  | 0                   |
| 63  | 2025-03-04       |                | 0           | 0                  | 0                   |
| 64  | 2025-03-05       |                | 0           | 0                  | 0                   |
| 65  | 2025-03-06       |                | 0           | 0                  | 0                   |
| 66  | 2025-03-07       |                | 0           | 0                  | 0                   |
| 67  | 2025-03-08       |                | 0           | 0                  | 0                   |
| 68  | 2025-03-09       |                | 0           | 0                  | 0                   |
| 69  | 2025-03-10       |                | 0           | 0                  | 0                   |
| 70  | 2025-03-11       |                | 0           | 0                  | 0                   |
| 71  | 2025-03-12       |                | 0           | 0                  | 0                   |
| 72  | 2025-03-13       |                | 0           | 0                  | 0                   |
| 73  | 2025-03-14       |                | 0           | 0                  | 0                   |

Algorithm:
  
  SalesPerformanceBySalesperson(startDate, endDate):
  1. Retrieve sales transactions within the specified date range (startDate to endDate).
  2. Group the transactions by salesperson (Salesperson ID or Name).
  3. Calculate total sales for each salesperson:
     Total Sales = Sum of (Quantity * Price) for each salesperson.
  4. Optionally calculate additional metrics (e.g., number of transactions or total quantity sold).
  5. Sort the salespeople by total sales in descending order (optional).
  6. Validate the totals (check for negative or invalid amounts).
  7. Store the report for each salesperson and return the results.

SQL:
  
WITH DateSeries AS (
    -- Generate a series of dates from startDate to endDate to ensure daily records
    SELECT generate_series(
        '2025-01-01'::DATE, 
        '2025-12-31'::DATE, 
        INTERVAL '1 day'
    )::DATE AS transaction_date
),
SalesData AS (
    -- Step 1: Retrieve sales transactions within the specified date range
    SELECT 
        salesperson_id,  -- Replace with appropriate column for salesperson identification
        transaction_date, 
        SUM(quantity * price) AS total_sales,  -- Total sales for each transaction
        COUNT(*) AS total_transactions,        -- Number of transactions for the salesperson (optional metric)
        SUM(quantity) AS total_quantity_sold  -- Total quantity sold by the salesperson (optional metric)
    FROM acc_transactions
    WHERE transaction_type = 'revenue' -- Sales transactions assumed to have 'revenue' as transaction type
      AND transaction_date BETWEEN '2025-01-01' AND '2025-12-31'
      AND is_active = TRUE
    GROUP BY salesperson_id, transaction_date
),
ValidatedSales AS (
    -- Step 6: Validate the totals (exclude invalid sales, e.g., negative sales or quantity)
    SELECT 
        salesperson_id, 
        transaction_date, 
        total_sales,
        total_transactions,
        total_quantity_sold
    FROM SalesData
    WHERE total_sales >= 0  -- Only consider valid sales (non-negative sales)
      AND total_quantity_sold >= 0 -- Only consider valid quantity sold (non-negative quantity)
)
-- Step 5: Join DateSeries to ensure daily records for each salesperson, even with no transactions
SELECT 
    ds.transaction_date,
    vs.salesperson_id,
    COALESCE(vs.total_sales, 0) AS total_sales,  -- If no sales for the date, return 0
    COALESCE(vs.total_transactions, 0) AS total_transactions,  -- If no transactions for the date, return 0
    COALESCE(vs.total_quantity_sold, 0) AS total_quantity_sold  -- If no quantity for the date, return 0
FROM DateSeries ds
LEFT JOIN ValidatedSales vs 
    ON ds.transaction_date = vs.transaction_date
ORDER BY ds.transaction_date, vs.salesperson_id;
